<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Ashwath Raj" />


<title>PM566 Final Project</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Happiness Report Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">PM566 Final Project</h1>
<h4 class="author">Ashwath Raj</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction:</h1>
<p>At the United Nations' event celebrating the International Day of Happiness on March 20, 2012, the first World Happiness Report was released. TED talks, conferences, fields of study, and decades of research are dedicated to the question &quot;What makes us happy?&quot; The report aimed to answer that question through &quot;happiness indicators&quot;. The researchers behind the report used data from the Gallup World Poll and answers to the Cantril ladder question (<a href="https://news.gallup.com/poll/122453/understanding-gallup-uses-cantril-scale.aspx" class="uri">https://news.gallup.com/poll/122453/understanding-gallup-uses-cantril-scale.aspx</a>), which are measurements of a respondent's imagined best (10) to worst (0) possible lives and where their lives fall on that scale. This score is broken into six factors: &quot;economic production, social support, life expectancy, freedom, absence of corruption, and generosity&quot;.</p>
<div id="i-want-to-examine-how-scores-change-year-over-year.-my-question-is" class="section level4">
<h4>I want to examine how scores change year over year. My question is:</h4>
</div>
<div id="which-indicators-are-responsible-for-the-largest-changes-in-happiness-score-between-2018-and-2019" class="section level4">
<h4>Which indicators are responsible for the largest changes in Happiness Score between 2018 and 2019?</h4>
<pre class="r"><code>library(tidyverse)
library(readr)
library(dtplyr)
library(data.table)
library(corrplot)</code></pre>
<pre class="r"><code>year1 &lt;- fread(&quot;2018.csv&quot;)
year2 &lt;- fread(&quot;2019.csv&quot;)</code></pre>
</div>
</div>
<div id="methods" class="section level1">
<h1>Methods:</h1>
<p>I obtained the data from <a href="https://www.kaggle.com/unsdsn/world-happiness" class="uri">https://www.kaggle.com/unsdsn/world-happiness</a>. I imported the data using fread() and used summary() to search for any missing values. The only missing value was in year1's Perceptions of corruption. I replaced that NA with year2's value, which is acceptable because a change (delta) of zero from year to year will not affect my question. However, it will allow me to use the other values for that location/row. Strangely, the same problem column was a different datatype in both years (char and dbl), so I cast them as doubles. After, I was able to merge the datasets and order them by Overall rank.</p>
<pre class="r"><code>#Add years and merge
year1 &lt;- year1 %&gt;%
  mutate(year = 2018)
year2 &lt;- year2 %&gt;%
  mutate(year = 2019)

#account for NA values
summary(year1)
summary(year2)
year1$&quot;Perceptions of corruption&quot;[20] &lt;- year2$`Perceptions of corruption`[21]

#originally for years1 and 2, one variable is sux
options(digits=5)
year1$`Perceptions of corruption` &lt;- as.double(year1$`Perceptions of corruption`)

years &lt;- merge(year1, year2, all.x = TRUE, all.y = TRUE)
years2 &lt;- lazy_dt(years)</code></pre>
<div id="methods-cont-eda" class="section level2">
<h2>Methods cont (EDA):</h2>
<p>I examined the dimensions and base R summary statisics of the years dataset. Notably with a score of 7.632 in 2018, Finland has the number one spot for both years, and their perceived healthy life expectancy went up by ~.1 while their perceived freedom went down by ~.1. Also, Norway and Denmark swapped positions for 2nd and 3rd rank. On the opposite end of the spectrum, Burundi and South Sudan have the lowest happiness score at 2.905 and 2.853 respectively. The lowest six countries report subscores all below 1 point, and the Central African Republic has scores of 0 for social support for both years. One of the few other 0's was Afghanistan for freedom to make life choices.</p>
<pre class="r"><code>dim(years)
head(years)
tail(years)
names(years)
str(years)
summary(years)

summary(year1$Score)
summary(year2$Score)</code></pre>
</div>
</div>
<div id="preliminary-results-and-eda-more-tools" class="section level1">
<h1>Preliminary Results and EDA (more tools!):</h1>
<p>The corrplot correlation matrix revealed the relationships between the subscores. Seeing these relationships are important for other questions and seeing the &quot;status quo&quot; of happiness indicators. That said, GDP per capita and Healthy Life expectancy were most highly correlated. I also looked at the shifting distributions of the subscores through histograms. Visually, the main changes were an increase in perceived corruption for the first quartile of countries (which means a lower score) and an increase in all countries' perceptions of Healthy life Expectancy. This is also reflected in their summary statistics. In boxplots, GDP seemed to increase, but only because the scale shifted. This was due to the absence of an outlier that was present in year1 but not year2- the United Arab Emirates' GDP score dropped from 2.096 to 1.684. This might indicate a change in how much happiness GDP per capita gives the citizens. Finally, the freedom subscore decreases and the perception of corruption score has the most outliers due to a majority of low values.</p>
<pre class="r"><code>#Correlation Matrix
corrplot(cor(year2[,3:9]), method = &quot;pie&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1,2))

#Histograms year1 vs year2
hist(year1$Score)
hist(year2$Score)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<pre class="r"><code>hist(year1$`Healthy life expectancy`)
hist(year2$`Healthy life expectancy`)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-5-3.png" width="672" /></p>
<pre class="r"><code>hist(year1$`Perceptions of corruption`)
hist(year2$`Perceptions of corruption`)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-5-4.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1,2))
#Boxplot outliers
boxplot(year1$&#39;GDP per capita&#39;)
boxplot(year2$&#39;GDP per capita&#39;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>boxplot(year1$`Freedom to make life choices`)
boxplot(year2$`Freedom to make life choices`)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<pre class="r"><code>boxplot(year1$`Perceptions of corruption`)
boxplot(year2$`Perceptions of corruption`)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<pre class="r"><code># Initial Plot, converted to combined plot below
# years %&gt;%
# filter(!(year %in% NA)) %&gt;%
#   ggplot() +
#   geom_point(mapping = aes(x = `Healthy life expectancy`, y = `Score`, color=year)) +
#   facet_wrap(~ year, nrow = 1)
# 
# ggplot(data=year1) +
#   geom_point(mapping=aes(x=year1$Generosity, y=year1$&#39;Score&#39;, color=cut(year1$&#39;Score&#39;, b = 5)))+
#   scale_color_manual(values = viridis::viridis(5)) +
#   geom_smooth(aes(x=year1$Generosity, y=year1$&#39;Score&#39;), method = &quot;lm&quot;)</code></pre>
</div>
<div id="results-cont" class="section level1">
<h1>Results cont:</h1>
<p>Based on the combined scatter/line plots and factorized years, the most significant changes between years occur from increases in Healthy life expectancy and decreases in Freedom to make choices. These increases can be seen through left and right translations on the x-axis. It's likely these changes aren't as visible on the 'Score' y-axis because the changes (approximately ~.1 each) cancel out when they contribute to the overall score. These findings agree with and expand upon with the EDA histogram and boxplot findings. The addition of the scatter/line plot makes the trends more visible.</p>
<pre class="r"><code>par(mfrow = c(7,1))
scatter_score &lt;- function(col,title){
ggplot(data = years, mapping = aes(x = col, y = `Score`, linetype=factor(year), color = factor(year))) +
  geom_point() +
  geom_smooth(se = FALSE) + 
  ggtitle(title)
}

scatter_score(years$`GDP per capita`, &quot;years$`GDP per capita`&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>scatter_score(years$`Social support`, &quot;years$`Social support`&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code>scatter_score(years$`Healthy life expectancy`, &quot;years$`Healthy life expectancy`&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<pre class="r"><code>scatter_score(years$`Freedom to make life choices`, &quot;years$`Freedom to make life choices`&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-8-4.png" width="672" /></p>
<pre class="r"><code>scatter_score(years$Generosity, &quot;years$Generosity&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-8-5.png" width="672" /></p>
<pre class="r"><code>scatter_score(years$`Perceptions of corruption`, &quot;years$`Perceptions of corruption`&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-8-6.png" width="672" /></p>
<div id="notes" class="section level3">
<h3>Notes:</h3>
<p>Annoying Problems: -year1 %&gt;% ggplot does not work unless variables use ` instead of ' or &quot;</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion:</h1>
<p>Of course, many complex factors contribute to national and individual happiness levels. They range from political and economic stability to social status and more. The Happiness Report provide provides a key benchmark for our understanding of happiness around the world.<br />
Over 2018 to 2019, there was not much change in happiness levels or their subscores. Most change was on the order of magnitude of 10^-1 for subscores. As stated before, the key changes were increase in Healthy life expectancy and decreases in Freedom scores. These findings and any other changes in happiness level, beg the question of why. What social, local, or global effects cause happiness levels to change or stay the same? Regardless of the answer, I hope this research and analysis gives the reader a sense of comfort that at least someone, somewhere is asking the questions necessary to build a happier world.</p>
<div id="finally-in-future-analysis-i-hope-to" class="section level3">
<h3>Finally, in future analysis I hope to:</h3>
<ul>
<li>Incorporate more years, which entails more data wrangling due to inconsistent collection
<ul>
<li>Possibly predict or interpolate other column values based on regressed values?</li>
</ul></li>
<li>Create comparison grids between countries and score</li>
<li>Create bar charts for each variable at each quartile</li>
<li>Create a stacked bar chart by column for every rank position</li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
